# Blunderbust Configuration File
# This file defines harness configurations for launching development environments
# in tmux windows. Each harness specifies how to invoke a tool with the right
# context for a given ticket.
#
# Template Loading:
# - Inline templates: specify template directly in YAML (default behavior)
# - File-based templates: use "@./path/to/file.txt" to load from external file
#   Paths are relative to the config file location
#   Example: command_template: "@./templates/opencode_command.txt"

# General application settings
general:
  # autostart_dolt: Automatically start the Dolt server if it's not running
  # When true: server will be started automatically on connection failure
  # When false: user will be prompted to start the server
  autostart_dolt: true

# Launcher configuration controls how new tmux windows are created
launcher:
  # target: Controls whether bdb switches focus to the new window
  #   foreground: Switch to the new window (default)
  #   background:  Create window in background without switching
  target: foreground

harnesses:
  # Opencode harness - launches opencode CLI with ticket context
  - name: opencode
    # Command template: rendered with Go text/template
    # Available fields: see TemplateContext in internal/domain/template_context.go
    # Includes: TicketID, TicketTitle, TicketDescription, TicketPriority, etc.
    #           HarnessName, Model, Agent
    #           RepoPath, Branch, WorkDir, User, Hostname
    #           DryRun, Debug, Timestamp
    command_template: "opencode --model {{.Model}} --agent {{.Agent}}"
    # Prompt template: optional, sent to the tool as context
    prompt_template: "Work on ticket {{.TicketID}}: {{.TicketTitle}}\n\n{{.TicketDescription}}"
    # Supported models for this harness
    # You can list specific models, use "provider:ID" to include all active
    # models from a provider, or "discover:active" to include all active models
    # from all providers.
    models:
      - discover:active
      - provider:google
      - claude-sonnet-4-20250514
      - o3
    # Supported agent modes
    agents:
      - coder
      - task
      - researcher
      - debugger
    # Environment variables to set when launching
    env:
      OPENCODE_LOG_LEVEL: "info"

  # Amp harness - Amp AI assistant with minimal configuration
  - name: amp
    # Simple command without template variables
    command_template: "amp"
    prompt_template: "Pick up {{.TicketID}}: {{.TicketTitle}}"
    models:
      - claude-sonnet-4-20250514
    # Empty agents list means this harness doesn't support agent selection
    agents: []

  # Claude Code harness - Direct claude-code invocation
  - name: claude-code
    command_template: "claude --model {{.Model}}"
    prompt_template: |
      Ticket: {{.TicketID}}
      Title: {{.TicketTitle}}
      Type: {{.TicketIssueType}}
      Priority: {{.TicketPriority}}
      
      {{.TicketDescription}}
    models:
      - claude-opus-4
      - claude-sonnet-4
      - claude-haiku-4
    agents:
      - code
      - architect

  # Example: File-based template loading
  # Create templates directory: mkdir -p templates
  # Create file: echo 'opencode --model {{.Model}}' > templates/cmd.txt
  # Then reference with @ syntax:
  # - name: file-example
  #   command_template: "@./templates/cmd.txt"
  #   prompt_template: "@./templates/prompt.txt"
  #   models: []
  #   agents: []

# Default selections for quickdraw/blitzdraw modes (optional)
defaults:
  harness: opencode
  model: claude-sonnet-4-20250514
  agent: coder
